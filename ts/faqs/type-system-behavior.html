<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>类型系统的行为 | 深入理解 TypeScript</title>
    <meta name="description" content="TypeScript Deep Dive 中文版">
    <link rel="icon" href="/ts/logo.png">
  <link rel="manifest" href="./manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/ts/assets/css/0.styles.3eb1b11f.css" as="style"><link rel="preload" href="/ts/assets/js/app.1500e12e.js" as="script"><link rel="preload" href="/ts/assets/js/3.a9f27590.js" as="script"><link rel="preload" href="/ts/assets/js/2.f01668b5.js" as="script"><link rel="preload" href="/ts/assets/js/32.f694875d.js" as="script"><link rel="prefetch" href="/ts/assets/js/10.818ab18a.js"><link rel="prefetch" href="/ts/assets/js/11.ce17e836.js"><link rel="prefetch" href="/ts/assets/js/12.5232df12.js"><link rel="prefetch" href="/ts/assets/js/13.eba59eb4.js"><link rel="prefetch" href="/ts/assets/js/14.7791aff6.js"><link rel="prefetch" href="/ts/assets/js/15.6f89cb60.js"><link rel="prefetch" href="/ts/assets/js/16.e208be1c.js"><link rel="prefetch" href="/ts/assets/js/17.5efc6105.js"><link rel="prefetch" href="/ts/assets/js/18.f12465ae.js"><link rel="prefetch" href="/ts/assets/js/19.ac9d09cc.js"><link rel="prefetch" href="/ts/assets/js/20.16c07106.js"><link rel="prefetch" href="/ts/assets/js/21.3c29aecd.js"><link rel="prefetch" href="/ts/assets/js/22.f8aef041.js"><link rel="prefetch" href="/ts/assets/js/23.568dc704.js"><link rel="prefetch" href="/ts/assets/js/24.dfbfbe05.js"><link rel="prefetch" href="/ts/assets/js/25.c067a33c.js"><link rel="prefetch" href="/ts/assets/js/26.c500e1b2.js"><link rel="prefetch" href="/ts/assets/js/27.33986276.js"><link rel="prefetch" href="/ts/assets/js/28.896a7ee3.js"><link rel="prefetch" href="/ts/assets/js/29.760369ac.js"><link rel="prefetch" href="/ts/assets/js/30.00a3394e.js"><link rel="prefetch" href="/ts/assets/js/31.a1db49eb.js"><link rel="prefetch" href="/ts/assets/js/33.f8c1aa15.js"><link rel="prefetch" href="/ts/assets/js/34.0b973591.js"><link rel="prefetch" href="/ts/assets/js/35.69e99035.js"><link rel="prefetch" href="/ts/assets/js/36.241184ba.js"><link rel="prefetch" href="/ts/assets/js/37.279d67e4.js"><link rel="prefetch" href="/ts/assets/js/38.01563728.js"><link rel="prefetch" href="/ts/assets/js/39.d6ba0922.js"><link rel="prefetch" href="/ts/assets/js/4.633d3f63.js"><link rel="prefetch" href="/ts/assets/js/40.5112a7f3.js"><link rel="prefetch" href="/ts/assets/js/41.fe28c52e.js"><link rel="prefetch" href="/ts/assets/js/42.cd3333c8.js"><link rel="prefetch" href="/ts/assets/js/43.966a35af.js"><link rel="prefetch" href="/ts/assets/js/44.59598f34.js"><link rel="prefetch" href="/ts/assets/js/45.74fe0949.js"><link rel="prefetch" href="/ts/assets/js/46.56f0f01e.js"><link rel="prefetch" href="/ts/assets/js/47.52ef9ec2.js"><link rel="prefetch" href="/ts/assets/js/48.02d934d2.js"><link rel="prefetch" href="/ts/assets/js/49.4a2e6814.js"><link rel="prefetch" href="/ts/assets/js/5.1a889786.js"><link rel="prefetch" href="/ts/assets/js/50.35c89dd1.js"><link rel="prefetch" href="/ts/assets/js/51.941e87a2.js"><link rel="prefetch" href="/ts/assets/js/52.5b0ba7c3.js"><link rel="prefetch" href="/ts/assets/js/53.aa7089a5.js"><link rel="prefetch" href="/ts/assets/js/54.258f089a.js"><link rel="prefetch" href="/ts/assets/js/55.d5efce1c.js"><link rel="prefetch" href="/ts/assets/js/56.bb2d649d.js"><link rel="prefetch" href="/ts/assets/js/57.84d6d0d7.js"><link rel="prefetch" href="/ts/assets/js/58.adb3b52d.js"><link rel="prefetch" href="/ts/assets/js/59.9af9a648.js"><link rel="prefetch" href="/ts/assets/js/6.3e9b2a3d.js"><link rel="prefetch" href="/ts/assets/js/60.15b9c120.js"><link rel="prefetch" href="/ts/assets/js/61.c7795f3e.js"><link rel="prefetch" href="/ts/assets/js/62.2969c841.js"><link rel="prefetch" href="/ts/assets/js/63.ee196d5b.js"><link rel="prefetch" href="/ts/assets/js/64.acf8210b.js"><link rel="prefetch" href="/ts/assets/js/65.5b47a7f4.js"><link rel="prefetch" href="/ts/assets/js/66.c29eee42.js"><link rel="prefetch" href="/ts/assets/js/67.673627be.js"><link rel="prefetch" href="/ts/assets/js/68.9c6c6246.js"><link rel="prefetch" href="/ts/assets/js/69.a6c8e6d8.js"><link rel="prefetch" href="/ts/assets/js/7.d43d9eaa.js"><link rel="prefetch" href="/ts/assets/js/70.5a0778c3.js"><link rel="prefetch" href="/ts/assets/js/71.89a1d79a.js"><link rel="prefetch" href="/ts/assets/js/72.3b512cd8.js"><link rel="prefetch" href="/ts/assets/js/73.33b51f4d.js"><link rel="prefetch" href="/ts/assets/js/74.7416c445.js"><link rel="prefetch" href="/ts/assets/js/75.ee9e179a.js"><link rel="prefetch" href="/ts/assets/js/76.89097125.js"><link rel="prefetch" href="/ts/assets/js/77.cd6c5e0e.js"><link rel="prefetch" href="/ts/assets/js/78.fe692470.js"><link rel="prefetch" href="/ts/assets/js/79.2af1a23e.js"><link rel="prefetch" href="/ts/assets/js/8.da864954.js"><link rel="prefetch" href="/ts/assets/js/80.284e21c9.js"><link rel="prefetch" href="/ts/assets/js/81.c58479fb.js"><link rel="prefetch" href="/ts/assets/js/82.76c84bf1.js"><link rel="prefetch" href="/ts/assets/js/83.f58c3a39.js"><link rel="prefetch" href="/ts/assets/js/84.697ef009.js"><link rel="prefetch" href="/ts/assets/js/85.dd3d7175.js"><link rel="prefetch" href="/ts/assets/js/86.2d7a2418.js"><link rel="prefetch" href="/ts/assets/js/87.a82e2044.js"><link rel="prefetch" href="/ts/assets/js/9.57f9ab4c.js">
    <link rel="stylesheet" href="/ts/assets/css/0.styles.3eb1b11f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/ts/" class="home-link router-link-active"><!----> <span class="site-name">深入理解 TypeScript</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://basarat.gitbooks.io/typescript/content/docs/getting-started.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  原书链接
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://jkchao.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/jkchao/typescript-book-chinese" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://basarat.gitbooks.io/typescript/content/docs/getting-started.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  原书链接
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://jkchao.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/jkchao/typescript-book-chinese" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <div class="wechat" data-v-4ee56da6><div class="item" data-v-4ee56da6><h6 class="title" style="display:;" data-v-4ee56da6>与我交流</h6> <div class="thumb" data-v-4ee56da6><img src="/typescript-book-chinese/contact.png" alt="与我交流" data-v-4ee56da6></div></div></div> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>写在前面</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ts/" class="sidebar-link">深入理解 TypeScript</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript 项目</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ts/project/compilationContext.html" class="sidebar-link">编译上下文</a></li><li><a href="/ts/project/declarationspaces.html" class="sidebar-link">声明空间</a></li><li><a href="/ts/project/modules.html" class="sidebar-link">模块</a></li><li><a href="/ts/project/namespaces.html" class="sidebar-link">命名空间</a></li><li><a href="/ts/project/dynamicImportExpressions.html" class="sidebar-link">动态导入表达式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript 类型系统</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ts/typings/overview.html" class="sidebar-link">概览</a></li><li><a href="/ts/typings/migrating.html" class="sidebar-link">从 JavaScript 迁移</a></li><li><a href="/ts/typings/types.html" class="sidebar-link">@types</a></li><li><a href="/ts/typings/ambient.html" class="sidebar-link">环境声明</a></li><li><a href="/ts/typings/interfaces.html" class="sidebar-link">接口</a></li><li><a href="/ts/typings/enums.html" class="sidebar-link">枚举</a></li><li><a href="/ts/typings/lib.html" class="sidebar-link">lib.d.ts</a></li><li><a href="/ts/typings/functions.html" class="sidebar-link">函数</a></li><li><a href="/ts/typings/callable.html" class="sidebar-link">可调用的</a></li><li><a href="/ts/typings/typeAssertion.html" class="sidebar-link">类型断言</a></li><li><a href="/ts/typings/freshness.html" class="sidebar-link">Freshness</a></li><li><a href="/ts/typings/typeGuard.html" class="sidebar-link">类型保护</a></li><li><a href="/ts/typings/literals.html" class="sidebar-link">字面量类型</a></li><li><a href="/ts/typings/readonly.html" class="sidebar-link">readonly</a></li><li><a href="/ts/typings/generices.html" class="sidebar-link">泛型</a></li><li><a href="/ts/typings/typeInference.html" class="sidebar-link">类型推断</a></li><li><a href="/ts/typings/typeCompatibility.html" class="sidebar-link">类型兼容性</a></li><li><a href="/ts/typings/neverType.html" class="sidebar-link">Never</a></li><li><a href="/ts/typings/discrominatedUnion.html" class="sidebar-link">辨析联合类型</a></li><li><a href="/ts/typings/indexSignatures.html" class="sidebar-link">索引签名</a></li><li><a href="/ts/typings/movingTypes.html" class="sidebar-link">流动的类型</a></li><li><a href="/ts/typings/exceptionsHanding.html" class="sidebar-link">异常处理</a></li><li><a href="/ts/typings/mixins.html" class="sidebar-link">混合</a></li><li><a href="/ts/typings/thisType.html" class="sidebar-link">ThisType</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JSX</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ts/jsx/support.html" class="sidebar-link">支持 JSX</a></li><li><a href="/ts/jsx/reactJSX.html" class="sidebar-link">React JSX</a></li><li><a href="/ts/jsx/nonReactJSX.html" class="sidebar-link">非 React JSX</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript 错误提示</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ts/error/interpreting.html" class="sidebar-link">解读 Errors</a></li><li><a href="/ts/error/common.html" class="sidebar-link">常见的 Error</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TIPs</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ts/tips/stringBasedEmuns.html" class="sidebar-link">基于字符串的枚举</a></li><li><a href="/ts/tips/nominalTyping.html" class="sidebar-link">名义化类型</a></li><li><a href="/ts/tips/statefulFunctions.html" class="sidebar-link">状态函数</a></li><li><a href="/ts/tips/bind.html" class="sidebar-link">Bind 是有害的</a></li><li><a href="/ts/tips/curry.html" class="sidebar-link">柯里化</a></li><li><a href="/ts/tips/typeInstantiation.html" class="sidebar-link">泛型的实例化类型</a></li><li><a href="/ts/tips/lazyObjectLiteralInitialization.html" class="sidebar-link">对象字面量的惰性初始化</a></li><li><a href="/ts/tips/classAreUseful.html" class="sidebar-link">类是有用的</a></li><li><a href="/ts/tips/avoidExportDefault.html" class="sidebar-link">export default 被认为是有害的</a></li><li><a href="/ts/tips/limitPropertySetters.html" class="sidebar-link">减少 setter 属性的使用</a></li><li><a href="/ts/tips/createArrays.html" class="sidebar-link">创建数组</a></li><li><a href="/ts/tips/outFileCaution.html" class="sidebar-link">谨慎使用 --outFile</a></li><li><a href="/ts/tips/staticConstructors.html" class="sidebar-link">TypeScript 中的静态构造函数</a></li><li><a href="/ts/tips/singletonPatern.html" class="sidebar-link">单例模式</a></li><li><a href="/ts/tips/functionParameters.html" class="sidebar-link">函数参数</a></li><li><a href="/ts/tips/truthy.html" class="sidebar-link">Truthy</a></li><li><a href="/ts/tips/buildToggles.html" class="sidebar-link">构建切换</a></li><li><a href="/ts/tips/typesafeEventEmitter.html" class="sidebar-link">类型安全的 Event Emitter</a></li><li><a href="/ts/tips/metadata.html" class="sidebar-link">Reflect Metadata</a></li><li><a href="/ts/tips/covarianceAndContravariance.html" class="sidebar-link">协变与逆变</a></li><li><a href="/ts/tips/infer.html" class="sidebar-link">infer</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript 编译原理</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ts/compiler/overview.html" class="sidebar-link">概览</a></li><li><a href="/ts/compiler/program.html" class="sidebar-link">程序</a></li><li><a href="/ts/compiler/ast.html" class="sidebar-link">抽象语法树</a></li><li><a href="/ts/compiler/scanner.html" class="sidebar-link">扫描器</a></li><li><a href="/ts/compiler/parser.html" class="sidebar-link">解析器</a></li><li><a href="/ts/compiler/binder.html" class="sidebar-link">绑定器</a></li><li><a href="/ts/compiler/checker.html" class="sidebar-link">检查器</a></li><li><a href="/ts/compiler/emitter.html" class="sidebar-link">发射器</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>TypeScript FAQs</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ts/faqs/common-bug-not-bugs.html" class="sidebar-link">一些常见的「bug」并不是 bug</a></li><li><a href="/ts/faqs/common-feature-request.html" class="sidebar-link">一些常见的 Feature 需求</a></li><li><a href="/ts/faqs/type-system-behavior.html" class="active sidebar-link">类型系统的行为</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#什么是结构化类型？" class="sidebar-link">什么是结构化类型？</a></li><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#什么是类型删除？" class="sidebar-link">什么是类型删除？</a></li><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#为什么没有-setter-时的-getter，没有被认为是只读？" class="sidebar-link">为什么没有 setter 时的 getter，没有被认为是只读？</a></li><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#为什么函数参数是双向协变？" class="sidebar-link">为什么函数参数是双向协变？</a></li><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#为什么有更少参数的函数能够赋值给具有更多参数的函数？" class="sidebar-link">为什么有更少参数的函数能够赋值给具有更多参数的函数？</a></li><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#为什么一个返回值不是-void-的函数，可以赋值给一个返回值为-void-的函数？" class="sidebar-link">为什么一个返回值不是 void 的函数，可以赋值给一个返回值为 void 的函数？</a></li><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#为什么所有的类型，都能赋值给一个空的接口？" class="sidebar-link">为什么所有的类型，都能赋值给一个空的接口？</a></li><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#我可以用名义上的类型别名吗？" class="sidebar-link">我可以用名义上的类型别名吗？</a></li><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#如何防止两种类型在结构上兼容？" class="sidebar-link">如何防止两种类型在结构上兼容？</a></li><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#如果对象实现了某个接口，我怎么在运行时检查？" class="sidebar-link">如果对象实现了某个接口，我怎么在运行时检查？</a></li><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#为什么错误的转化不会引起运行时的错误？" class="sidebar-link">为什么错误的转化不会引起运行时的错误？</a></li><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#为什么我没有为-number-string-或者-t-t-进行类型检查？" class="sidebar-link">为什么我没有为 (number) =&gt; string 或者 (T) =&gt; T 进行类型检查？</a></li><li class="sidebar-sub-header"><a href="/ts/faqs/type-system-behavior.html#为什么我会得到-supplied-parameters-do-not-match-any-signature-的错误？" class="sidebar-link">为什么我会得到 Supplied parameters do not match any signature 的错误？</a></li></ul></li><li><a href="/ts/faqs/function.html" class="sidebar-link">函数</a></li><li><a href="/ts/faqs/class.html" class="sidebar-link">类</a></li><li><a href="/ts/faqs/generics.html" class="sidebar-link">泛型</a></li><li><a href="/ts/faqs/modules.html" class="sidebar-link">模块</a></li><li><a href="/ts/faqs/enums.html" class="sidebar-link">枚举</a></li><li><a href="/ts/faqs/type-guards.html" class="sidebar-link">类型守卫</a></li><li><a href="/ts/faqs/jsx-and-react.html" class="sidebar-link">JSX 和 React</a></li><li><a href="/ts/faqs/thing-that-dont-work.html" class="sidebar-link">一些不能按预期工作的代码</a></li><li><a href="/ts/faqs/commandline-behavior.html" class="sidebar-link">命令行的行为</a></li><li><a href="/ts/faqs/tsconfig-behavior.html" class="sidebar-link">tsconfig.json 的行为</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="wechat" data-v-4ee56da6><div class="item" data-v-4ee56da6><h6 class="title" style="display:;" data-v-4ee56da6>与我交流</h6> <div class="thumb" data-v-4ee56da6><img src="/typescript-book-chinese/contact.png" alt="与我交流" data-v-4ee56da6></div></div></div> <div class="content content__default"><h1 id="类型系统的行为"><a href="#类型系统的行为" class="header-anchor">#</a> 类型系统的行为</h1> <h2 id="什么是结构化类型？"><a href="#什么是结构化类型？" class="header-anchor">#</a> 什么是结构化类型？</h2> <p>TypeScript 使用<strong>结构化类型</strong>，这个系统并不同于你可能使用过的一些其他流行语言（如：Java、C# 等）的类型系统。</p> <p>结构化类型系统背后的思想是如果他们的成员类型是兼容的，则他们是兼容的。例如：在 C# 或者 Java 中，有两个名为 <code>MyPoint</code> 和 <code>YourPoint</code> 的类，它们都具有公共 <code>int</code> 类型的属性 <code>x</code> 和 <code>y</code>，这两个类是不可互换的。但在结构化的类型系统中（TypeScript），这些类型具有不同名称的事实并不重要，因为它们具有相同类型的成员，所以它们是相同的（可以互换的）。</p> <p>这也适用于子类型关系。例如：在 C++ 中，如果 <code>Animal</code> 是 <code>Dog</code> 的父类，你只能使用 <code>Dog</code> 来替代 <code>Animal</code>。在 TypeScript 中，并不是如此，具有至少与 <code>Animal</code> 相同数量的成员（适当的类型）的 <code>Dog</code>，才是 <code>Animal</code> 的子类型，而不管是否是继承关系。</p> <p>这对于习惯于使用名义类型语言的程序员来说，会产生一些令人惊讶的结果。在这个 FAQs 中的许多问题，都可以追溯到结构化类型及其含义。一旦你掌握了它的基础知识，就很容易理解了。</p> <h2 id="什么是类型删除？"><a href="#什么是类型删除？" class="header-anchor">#</a> 什么是类型删除？</h2> <p>TypeScript 移除了类型断言、接口、类型别名和一些其他编译期间的类型结构。</p> <p>输入：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">var</span> x<span class="token punctuation">:</span> SomeInterface<span class="token punctuation">;</span>
</code></pre></div><p>输出：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">var</span> x<span class="token punctuation">;</span>
</code></pre></div><p>这意味着，在运行时，没有信息表明变量 <code>x</code> 的类型是 <code>SomeInterface</code>。</p> <p>对于习惯使用反射或其他元数据系统的程序员来说，缺少的运行时类型信息可能是令人惊讶的。FAQs 中的许多问题都可以归结为「因为类型被删除」。</p> <h2 id="为什么没有-setter-时的-getter，没有被认为是只读？"><a href="#为什么没有-setter-时的-getter，没有被认为是只读？" class="header-anchor">#</a> 为什么没有 setter 时的 getter，没有被认为是只读？</h2> <blockquote><p>我写下一段代码，并且期望它会抛出错误</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token keyword">get</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">42</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Expected error here</span>
x<span class="token punctuation">.</span>bar <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div><p>这在 TypeScript 2.0 + 中会抛出错误。具体请看 <a href="https://github.com/Microsoft/TypeScript/issues/12" target="_blank" rel="noopener noreferrer">#12<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="为什么函数参数是双向协变？"><a href="#为什么函数参数是双向协变？" class="header-anchor">#</a> 为什么函数参数是双向协变？</h2> <blockquote><p>我写下一段代码，并且期望它会抛出错误</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">trainDog</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token punctuation">:</span> Dog</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">cloneAnimal</span><span class="token punctuation">(</span>source<span class="token punctuation">:</span> Animal<span class="token punctuation">,</span> <span class="token function-variable function">done</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">result<span class="token punctuation">:</span> Animal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Runtime error here occurs because we end up invoking 'trainDog' with a 'Cat'</span>
<span class="token function">cloneAnimal</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> trainDog<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这是由于类型系统中缺乏显示协变/逆变注解而导致的不健全。由于它们的缺失，当被问及到 <code>(x: Dog) =&gt; void</code> 是否能够赋值给 <code>(x: Animal) =&gt; void</code> 时，TypeScript 必须更加的宽容处理。</p> <p>为了理解为什么是这样，我们来思考两个问题：<code>Dog[]</code> 是 <code>Animal[]</code> 的子类型吗？在 TypeScript 中 <code>Dog[]</code> 是否应该是 <code>Animal[]</code> 的子类型？</p> <p>第二个问题很容易分析，如果它的答案是 <code>no</code> 了？</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">checkIfAnimalsAreAwake</span><span class="token punctuation">(</span><span class="token parameter">arr<span class="token punctuation">:</span> Animal<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>

<span class="token keyword">let</span> myPets<span class="token punctuation">:</span> Dog<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>spot<span class="token punctuation">,</span> fido<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// Error? Can't substitute Dog[] for Animal[] ?</span>
<span class="token function">checkIfAnimalsAreAwake</span><span class="token punctuation">(</span>myPets<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这将是非常烦人。在 <code>checkIfAnimalsAreAwake</code> 没有修改 arr 的情况下，这段代码 100% 是正确的。没有充足的理由来认为 <code>Dog[]</code> 不能被赋值给 <code>Animal[]</code> - 在这里很明显，一组 <code>Dog</code> 是一组 <code>Anumal</code>。</p> <p>回到第一个问题，类型系统什么时候会决定 <code>Dog[]</code> 是 <code>Animal[]</code> 的子类型。它将会进行以下计算（写到这里，编译器好像没有进行任何优化）：</p> <ul><li><code>Dog[]</code> 可以被赋值给 <code>Animal[]</code> 类型吗？</li> <li><code>Dog[]</code> 的每个成员都可以被赋值给 <code>Animal[]</code> 吗？
<ul><li><code>Dog[].push</code> 可以赋值给 <code>Animal[].push</code> 吗？
<ul><li>类型 <code>(x: Dog) =&gt; number</code> 可以赋值给 <code>(x: Animal) =&gt; number</code> 吗？
<ul><li><code>(x: Dog) =&gt; number</code> 的第一个参数的类型，可以赋值给 <code>(x: Animal) =&gt; number</code> 的第一个参数吗？
<ul><li><code>Dog</code> 可以赋值给 <code>Animal</code> 吗？
<ul><li>是的</li></ul></li></ul></li></ul></li></ul></li></ul></li></ul> <p>如你所看到的一样，类型系统在检查类型是否可以赋值时，它会提问「<code>(x: Dog) =&gt; number</code> 的类型能赋值给 <code>(x: Animal) =&gt; number</code> 吗？」，这与类型系统要求原始类型所需的问题相同。如果 TypeScript 强制函数参数进行逆变（<code>Animal</code> 可以赋值给 <code>Dog</code>），这可能会导致 <code>Dog[]</code> 并不能赋值给 <code>Animal[]</code>。</p> <p>总的来说，在 TypeScript 的类型系统里，一个接收更多特定类型参数的函数是否能够赋值给一个较少特定类型参数的函数的问题，它的答案有一个先决条件 - 有更多特定类型的数组能够赋值到一个较少特定类型的数组吗？在大多数情况下，如果后者不是这情情况，则认为是不被允许的。所以我们必须对函数参数类型的特定情况进行正确的权衡。</p> <h2 id="为什么有更少参数的函数能够赋值给具有更多参数的函数？"><a href="#为什么有更少参数的函数能够赋值给具有更多参数的函数？" class="header-anchor">#</a> 为什么有更少参数的函数能够赋值给具有更多参数的函数？</h2> <blockquote><p>我写下这段代码，并期望它抛出错误</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">arg<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ....</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token function-variable function">callback</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">arg1<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> arg2<span class="token punctuation">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">callback</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Expected error because 'doSomething' wants a callback of</span>
<span class="token comment">// 2 parameters, but 'handler' only accepts 1</span>
<span class="token function">doSomething</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这是预期和期望的行为。首先，参考在顶部 FAQ 中的 「substitutability」（译者注：「substitutability」会在接下来的术语专题中解释） - <code>handler</code> 是回调函数中的有效参数，因为它可以安全的忽略额外的参数。</p> <p>其次，让我们来探讨下另外一个用例：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
items<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">arg</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这也可以看成一个「期望的错误」。在运行时，<code>forEach</code> 使用三个参数调用指定的回调函数，但是在大多数情况下，回调函数仅仅使用一个或者两个参数。这是一种非常常见的 JavaScript 模式，必须明确声明所有未使用的参数是很麻烦的。</p> <blockquote><p>但是 <code>forEach</code> 仅仅是标记它的参数作为可选项，例如：<code>forEach(callback: (element?: T, index?: number, array?: T[]))</code></p></blockquote> <p>这并不是可选回调函数的含义。始终从函数调用者的角度去读取函数签名，如果 <code>forEach</code> 声明回调函数是可选的，这意味着 <code>forEach</code> 可能会使用 0 参数来调用回调函数。</p> <p>一个可选的回调函数参数的含义是：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Invoke the provided function with 0 or 1 argument</span>
<span class="token keyword">function</span> <span class="token function">maybeCallWithArg</span><span class="token punctuation">(</span><span class="token function-variable function">callback</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>forEach</code> 总是为其回调函数提供所有的三个参数。你不必检查 <code>index</code> 参数是否为 undefined - 它始终存在，并不是可选的。</p> <p>目前在 TypeScript 没有存在一种方法可以指示回调函数的参数必须存在。注意，这种强制执行，并不会修复一个错误。换句话说，我们假设每一个回调函数中必须至少有一个参数，你可能会写下以下代码：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'just counting'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//   ~~ Error, not enough arguments?</span>
</code></pre></div><p>我们可以通过添加一个参数来修复它，但是它可能不是很正确</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'just counting'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// OK, but doesn't do anything different at all</span>
</code></pre></div><h2 id="为什么一个返回值不是-void-的函数，可以赋值给一个返回值为-void-的函数？"><a href="#为什么一个返回值不是-void-的函数，可以赋值给一个返回值为-void-的函数？" class="header-anchor">#</a> 为什么一个返回值不是 <code>void</code> 的函数，可以赋值给一个返回值为 <code>void</code> 的函数？</h2> <blockquote><p>我写下这段代码，并期望它抛出错误</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">callMeMaybe</span><span class="token punctuation">(</span><span class="token function-variable function">callback</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Expected an error because 'doSomething' returns number, but 'callMeMaybe'</span>
<span class="token comment">// expects void-returning function</span>
<span class="token function">callMeMaybe</span><span class="token punctuation">(</span>doSomething<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这是预期和期望的行为。首先，参考在顶部的 FAQ 中的 「substitutability」- 相比于 <code>callMeMaybe</code>, <code>doSomething</code> 返回「更多」的信息，<code>callMeMaybe</code> 是一个有效的替代品。</p> <p>其次，让我们来探讨下另外一个用例：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">callMeMaybe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这也可以看成是一个「期望的错误」。 <code>Array#push</code> 会返回一个数字（数组的新长度），但是它使用在一个返回值为 <code>void</code> 的函数上，它是一个安全的替代品。</p> <p>另外一种思考这个问题的方式是：一个返回值类型为 <code>void</code> 的函数，它会说：“无论你的返回值是否存在，我都不会检查它”。</p> <h2 id="为什么所有的类型，都能赋值给一个空的接口？"><a href="#为什么所有的类型，都能赋值给一个空的接口？" class="header-anchor">#</a> 为什么所有的类型，都能赋值给一个空的接口？</h2> <blockquote><p>我写下这段代码，并期望它抛出错误</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Thing</span> <span class="token punctuation">{</span>
  <span class="token comment">/* nothing here */</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">:</span> Thing</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// mysterious implementation here</span>
<span class="token punctuation">}</span>
<span class="token comment">// Expected some or all of these to be errors</span>
<span class="token function">doSomething</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token string">'huh?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>没有成员的类型，能够被任何类型替代。在这个例子中，<code>window</code>、<code>42</code>、<code>huh</code> 都能取代 <code>Thing</code>。</p> <p>通常来说，你永远不应该声明没有属性的 <code>interface</code>。</p> <h2 id="我可以用名义上的类型别名吗？"><a href="#我可以用名义上的类型别名吗？" class="header-anchor">#</a> 我可以用名义上的类型别名吗？</h2> <blockquote><p>我写下这段代码，并期望它抛出错误</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> SomeUrl <span class="token operator">=</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> FirstName <span class="token operator">=</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> x<span class="token punctuation">:</span> SomeUrl <span class="token operator">=</span> <span class="token string">'http://www.typescriptlang.org/'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y<span class="token punctuation">:</span> FirstName <span class="token operator">=</span> <span class="token string">'Bob'</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// Expected error</span>
</code></pre></div><p>类型别名只是一个简单的别名，它们无法区分自己所表示的类型。</p> <p>这有一个涉及到使用交叉类型的解决办法：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Strings here are arbitrary, but must be distinct</span>
<span class="token keyword">type</span> SomeUrl <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span> <span class="token string">'this is a url'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> FirstName <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span> <span class="token string">'person name'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Add type assertions</span>
<span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token operator">&lt;</span>SomeUrl<span class="token operator">&gt;</span><span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token operator">&lt;</span>FirstName<span class="token operator">&gt;</span><span class="token string">'bob'</span><span class="token punctuation">;</span>
x <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// Error</span>

<span class="token comment">// OK</span>
<span class="token keyword">let</span> xs<span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> x<span class="token punctuation">;</span>
<span class="token keyword">let</span> ys<span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> y<span class="token punctuation">;</span>
xs <span class="token operator">=</span> ys<span class="token punctuation">;</span>
</code></pre></div><p>你需要在创建值的任何位置添加类型断言，但是它仍然可以使用 <code>string</code> 别名，并且会失去类型的安全性。</p> <h2 id="如何防止两种类型在结构上兼容？"><a href="#如何防止两种类型在结构上兼容？" class="header-anchor">#</a> 如何防止两种类型在结构上兼容？</h2> <blockquote><p>我写下这段代码，并期望它抛出错误</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">ScreenCoordinate</span> <span class="token punctuation">{</span>
  x<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  y<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">PrintCoordinate</span> <span class="token punctuation">{</span>
  x<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  y<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">sendToPrinter</span><span class="token punctuation">(</span><span class="token parameter">pt<span class="token punctuation">:</span> PrintCoordinate</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getCursorPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> ScreenCoordinate <span class="token punctuation">{</span>
  <span class="token comment">// Not a real implementation</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// This should be an error</span>
<span class="token function">sendToPrinter</span><span class="token punctuation">(</span><span class="token function">getCursorPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果你真的希望两种类型不兼容，有一种方式添加一个 「brand」 成员：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">ScreenCoordinate</span> <span class="token punctuation">{</span>
  _screenCoordBrand<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  x<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  y<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">PrintCoordinate</span> <span class="token punctuation">{</span>
  _printCoordBrand<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  x<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  y<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Error</span>
<span class="token function">sendToPrinter</span><span class="token punctuation">(</span><span class="token function">getCursorPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p> 请注意，这将需要在创建「brand」的地方使用类型断言：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">getCursorPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> ScreenCoordinate <span class="token punctuation">{</span>
  <span class="token comment">// Not a real implementation</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>ScreenCoordinate<span class="token operator">&gt;</span><span class="token punctuation">{</span> x<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>另外你也可以查看此 <a href="https://github.com/Microsoft/TypeScript/issues/202" target="_blank" rel="noopener noreferrer">#202<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 来获取更多有关于此问题的信息；</p> <h2 id="如果对象实现了某个接口，我怎么在运行时检查？"><a href="#如果对象实现了某个接口，我怎么在运行时检查？" class="header-anchor">#</a> 如果对象实现了某个接口，我怎么在运行时检查？</h2> <blockquote><p>我写下了像下面的一段代码</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">SomeInterface</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  length<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">SomeOtherInterface</span> <span class="token punctuation">{</span>
  questions<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">:</span> SomeInterface <span class="token operator">|</span> SomeOtherInterface</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Can't use instanceof on interface, help?</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token keyword">instanceof</span> <span class="token class-name">SomeInterface</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在编译时期， TypeScript 的类型被删除。这意味着没有用于执行运行时类型检查的内置机制。这完全取决与你如何鉴别对象。一个比较广泛的用法是检查某个对象里的属性。你可以使用用户定义的类型保护来实现它：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">isSomeInterface</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> x <span class="token keyword">is</span> SomeInterface <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">typeof</span> x<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> x<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">:</span> SomeInterface<span class="token operator">|</span>SomeOtherInterface</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isSomeInterface</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Cool!</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="为什么错误的转化不会引起运行时的错误？"><a href="#为什么错误的转化不会引起运行时的错误？" class="header-anchor">#</a> 为什么错误的转化不会引起运行时的错误？</h2> <blockquote><p>我写下一些代码：</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> x<span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span>x<span class="token punctuation">;</span> <span class="token comment">// Expected: runtime error (can't convert boolean to string)</span>
</code></pre></div><p>或者是这样：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> a<span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token string">'hmm'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> a <span class="token keyword">as</span> HTMLElement<span class="token punctuation">;</span> <span class="token comment">// expected b === null</span>
</code></pre></div><p>TypeScript 拥有类型断言，但这并不是一个「casts」：<code>&lt;T&gt; x</code> 仅仅是用来告诉 TypeScript：「TypeScript，请将 <code>x</code> 的类型认为是 <code>T</code>」，而不是执行类型安全的运行时转换。因为类型被删除，没有直接等价于 C# 的 <code>expr as</code> 或者是 <code>(type)expr</code> 的语法。</p> <h2 id="为什么我没有为-number-string-或者-t-t-进行类型检查？"><a href="#为什么我没有为-number-string-或者-t-t-进行类型检查？" class="header-anchor">#</a> 为什么我没有为 <code>(number) =&gt; string</code> 或者 <code>(T) =&gt; T</code> 进行类型检查？</h2> <blockquote><p>我写下这段代码，并期望它抛出错误</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">myFunc</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function-variable function">string</span> <span class="token operator">=</span> <span class="token parameter">n</span> <span class="token operator">=&gt;</span> <span class="token string">'The number in hex is '</span> <span class="token operator">+</span> n<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Expected error because boolean is not number</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">myFunc</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在函数的类型中，参数名字是必须的。上面那段代码描述了一个参数名是 <code>number</code>，类型是 <code>any</code> 的函数。换句话说，这个声明：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">myFunc</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</code></pre></div><p>它等价于这个：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">myFunc</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token builtin">number</span><span class="token punctuation">:</span> <span class="token builtin">any</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</code></pre></div><p>你应该写成：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">let</span> <span class="token function-variable function">myFunc</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">myArgName<span class="token punctuation">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</code></pre></div><p>为了避免这些问题，你需要开启 <code>noImplicitAny</code> 选项，当检测到有任何参数的类型为 <code>any</code> 时，它将会发出一个警告。</p> <h2 id="为什么我会得到-supplied-parameters-do-not-match-any-signature-的错误？"><a href="#为什么我会得到-supplied-parameters-do-not-match-any-signature-的错误？" class="header-anchor">#</a> 为什么我会得到 <code>Supplied parameters do not match any signature</code> 的错误？</h2> <p>函数实现签名，它并不是重载的一部分：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">createLog</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">createLog</span><span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> message<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">createLog</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>
<span class="token function">createLog</span><span class="token punctuation">(</span><span class="token string">'source'</span><span class="token punctuation">,</span> <span class="token string">'message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ERROR: Supplied parameters do not match any signature</span>
</code></pre></div><p>当至少具有一个函数重载的签名时，只有重载是可见的。最后一个声明签名（也可以被称为签名的实现）对签名的形状并没有贡献，因此，要获得所需的行为，你需要添加额外的重载：</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">createLog</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">createLog</span><span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> message<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">createLog</span><span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> message<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>由于 JavaScript 没有函数重载，我们不得不这么做，因此你需要在你的函数中进行参数检查。</p> <p>例如，你可以要求你的使用者使用匹配的参数对来调用，并正确实现它，而不允许混合参数类型。</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token comment">// Just an implementation and not visible to callers</span>
<span class="token punctuation">}</span>

<span class="token function">compare</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>
<span class="token function">compare</span><span class="token punctuation">(</span><span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>
<span class="token function">compare</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error.</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/jkchao/typescript-book-chinese/edit/master/docs/faqs/type-system-behavior.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">10/28/2019, 8:24:48 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/ts/faqs/common-feature-request.html" class="prev">
          一些常见的 Feature 需求
        </a></span> <span class="next"><a href="/ts/faqs/function.html">
          函数
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/ts/assets/js/app.1500e12e.js" defer></script><script src="/ts/assets/js/3.a9f27590.js" defer></script><script src="/ts/assets/js/2.f01668b5.js" defer></script><script src="/ts/assets/js/32.f694875d.js" defer></script>
  </body>
</html>
